\subsection{UDP measurements}\label{sec_udp_mes}

\subsection*{Purpose:}

To determine the maximum frequency that can be used with the UDP protocol. To do so, we will measure the round time trip delay and jitter and look at those values as a function of the delay used in the sending loop.

\subsection*{Test equipment:}

The sbRIO 9636 is connected to a computer running Ubuntu 14.04 LTS via an Ethernet cable of 1 gpbs. The computer runs the ROS nodes that are used for the project, thus it communicates with both the Geomagic Touch and the sbRIO and it sends random setpoints to the sbRIO. The sbRIO uses the entire code of the project.

\subsection*{Procedure:}

\begin{enumerate}
	\item The sbRIO is started and connected to the computer.
	\item The ROS node is started.
	\item tshark is started.% using this command: $tshark -i 1 -f udp -a duration:20 -w ~/wireshark_capture$
	\item Once the Wireshark recording is done the ROS node is stopped.
	\item The log files are retrieved to be analyzed using Matlab and Wireshark.
\end{enumerate}
Those steps are repeated for both the serial and parallel case for the following settings: 10 ms, 2 ms and 0 ms.


\subsection*{Measuring data:}

\begin{center}
  $\begin{tabular}{|c|c|c|c|c|c|}
    \hline
    \text{Delay} & \text{Frequency (Hz)} & \text{RTT* delay (ms)} & \text{Jitter} & \text{Error rate (\%)}\\
    \hline
    10ms & 86 & 1.1 & 4.9E-8 & 0 \\
    %\hline
    %2ms & 447 & 2.1 & 3.5 & 1.2E-4 \\
    \hline
    0ms & 981 & 1.3 & 6.1E-8 & 5.1E-5 \\
    \hline
  \end{tabular}$
	\captionof{table}{UDP}
\end{center}{}

\begin{figure}[H]
\centering
	\begin{subfigure}{.45\textwidth}
	    \centering
	    \input{../Worksheets/rapport/pictures/10ms}
	    \caption{10ms}
	\end{subfigure} 
	\begin{subfigure}{.45\textwidth}
	    \centering
	    \input{../Worksheets/rapport/pictures/0ms}
	    \caption{0ms}
	\end{subfigure} 
	\label{Representation of the RTT delay for different frequencies}
\end{figure}
\todo{remake graph and table with the controller running}

\subsection*{Results:}

As the frequency of the communication increases, the delay becomes more and more sensitive to the disturbances caused by the preemption of other processes on the computer and as such the behavior of the system will become unpredictable. 

\subsection*{Conclusion:}

As of now, the communication that uses UDP can reach up to 981Hz which meet our requirement of being higher than 300Hz. However the current measurements are taken without the controller running and need to be done again on the final configuration.